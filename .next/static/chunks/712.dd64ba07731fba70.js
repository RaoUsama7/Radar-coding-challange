"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[712],{8712:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var n=a(2265),r=a(1080),o=a(759),s=a.n(o);async function l(){let e=await fetch("/api/radar/latest?ts=".concat(Date.now()),{cache:"no-store"});if(!e.ok)throw Error("Failed to load radar data: ".concat(e.status," ").concat(e.statusText));return e.json()}function i(){let e=(0,r.mE)().map,t=(0,n.useRef)(null),[a,o]=(0,n.useState)(null),i=(0,n.useRef)(null),c=e=>s().latLngBounds(s().latLng(e[0][0],e[0][1]),s().latLng(e[1][0],e[1][1])),u=e=>e?e.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--:--";return(0,n.useEffect)(()=>{let a=!1;async function n(){try{var n;console.log("Fetching radar data...");let r=await l();if(console.log("Radar data received:",{message:r.message,hasImageBase64:!!r.imageBase64,imageBase64Length:(null===(n=r.imageBase64)||void 0===n?void 0:n.length)||0,bounds:r.bounds,timestamp:r.timestamp}),a)return;if(!r.imageBase64)throw Error("No imageBase64 data received from API");let i="data:image/svg+xml;base64,".concat(r.imageBase64);console.log("Created data URI, length:",i.length);let u=c(r.bounds);console.log("Bounds:",u),t.current&&(t.current.remove(),t.current=null),console.log("Creating Leaflet image overlay...");let d=s().imageOverlay(i,u,{opacity:.85,interactive:!1,zIndex:500});t.current=d.addTo(e),console.log("Overlay added to map successfully"),o(new Date(r.timestamp))}catch(e){console.error("Failed to load radar overlay:",e),e instanceof Error&&console.error("Error details:",{message:e.message,stack:e.stack})}}n();let r=setInterval(n,12e4);return()=>{a=!0,clearInterval(r)}},[e,12e4]),(0,n.useEffect)(()=>()=>{t.current&&(t.current.remove(),t.current=null)},[]),(0,n.useEffect)(()=>{if(!e||i.current)return;let t=new(s().Control.extend({onAdd:function(){let e=s().DomUtil.create("div","radar-timestamp-control");return e.innerHTML='\n          <div style="\n            background: rgba(0, 0, 0, 0.7);\n            color: white;\n            padding: 6px 12px;\n            border-radius: 4px;\n            font-family: system-ui, -apple-system, sans-serif;\n            font-size: 12px;\n            font-weight: 500;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n          ">\n            Last updated: <span id="radar-timestamp">'.concat(u(a),"</span>\n          </div>\n        "),s().DomEvent.disableClickPropagation(e),i.current=e,e},onRemove:function(){i.current=null}}))({position:"bottomright"});return t.addTo(e),()=>{e.removeControl(t)}},[e]),(0,n.useEffect)(()=>{if(i.current){let e=i.current.querySelector("#radar-timestamp");e&&(e.textContent=u(a))}},[a]),null}}}]);